{% extends "base.html" %}
{% load static %}

{% block links %}
    <link rel="stylesheet" href="{% static 'css/my_settings/albums.css' %}">
{% endblock %}

{% block title %}
    –ê–ª—å–±–æ–º–∏
{% endblock %}

{% block content %}
    <div id="albums-page-content">
        <div id="sidebar">
            <a href="{% url 'settings' %}" id="profile-url" class="sidebar-url">–û—Å–æ–±–∏—Å—Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</a>
            <a href="{% url 'albums' %}" id="albums-url" class="sidebar-url">–ê–ª—å–±–æ–º–∏</a>
            <hr>
        </div>
        <div id="sidebar-block"></div>
        <div id="albums-panel">
            <div id="my-photos-window">
                <div id="my-photos-header">
                    <h4>–ú–æ—ó —Ñ–æ—Ç–æ</h4>
                    <form id="add-photo-button">
                        {% csrf_token %}
                        <button type="submit" id="add-photo"><img src="/placeholder.svg" alt="">–î–æ–¥–∞—Ç–∏ —Ñ–æ—Ç–æ</button>
                    </form>
                </div>

                <div id="user-photo-list" class = 'photo-list'>

                    {% for avatar in user.profile.avatar_set.all %}
                        {% if avatar.shown %}
                            <div class="user-photo-container">
                                <img src="{{ avatar.image.url }}" alt="avatar">
                                <button type="button" class="delete-user-photo-btn" data-avatar-id="{{ avatar.id }}">üóë</button>
                            </div>
                        {% endif %}
                    {% endfor %}

                    
                    <button type="button" id="add-user-photo-main" class="add-photo-button">‚äï</button>
                    <input type="file" id="user-photo-input" style="display: none;" accept="image/*">
                </div>

            </div>

            <div id="create-albums-window">
                <div id="create-albums-header">
                    {% if album_availability == False %}
                        <h4>–ù–µ–º–∞—î —â–µ –∂–æ–¥–Ω–æ–≥–æ –∞–ª—å–±–æ–º—É</h4>
                    {% else %}
                        <h4>–°—Ç–≤–æ—Ä—ñ—Ç—å –∞–ª—å–±–æ–º</h4>
                    {% endif %}
                    <form id="create-albums-button">
                        {% csrf_token %}
                        <button type="submit" id="create-albums"><img src="/placeholder.svg" alt="">–°—Ç–≤–æ—Ä–∏—Ç–∏ –∞–ª—å–±–æ–º</button>
                    </form>
                </div>
            </div>

            {% if album_availability == True %}
                {% for album_data in albums_with_images %}
                    <div class = "album-content">
                        
                        <div class = "album-header">
                            <h4 class = 'album-header-name'>{{ album_data.album.name }}</h4>
                            <div class = "header-buttons-conteiner">
                                
                                <button type="button"
                                    class = "delete-album-button"
                                    data-album-id = "{{ album_data.album.id }}">üëÅ</button>
                                <button class="open-album-menu">‚ãÆ</button>

                                <div class = 'album-menu' display = 'none'>
                                    {% if album_data.album.shown == False %}
                                        <button type="button"
                                                class = "show-visibility-button menu-button"
                                                data-album-id = "{{ album_data.album.id }}">üëÅ –¶–µ–π –∞–ª—å–±–æ–º –±–∞—á–∏—Ç–µ —Ç—ñ–ª—å–∫–∏ –≤–∏</button>
                                    {% else %}
                                        <button type="button"
                                                class = "hide-visibility-button menu-button"
                                                data-album-id = "{{ album_data.album.id }}">üëÅ –¶–µ–π –∞–ª—å–±–æ–º –±–∞—á–∞—Ç—å –≤—Å—ñ</button>
                                    {% endif %}

                                    <button type="button"
                                            class = "edit-album-button menu-button"
                                            data-album-id = "{{ album_data.album.id }}">‚úé –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∞–ª—å–±–æ–º</button>

                                    <hr>

                                    <button type="button"
                                            class = "delete-album-in-menu-button"
                                            data-album-id = "{{ album_data.album.id }}">üóë –í–∏–¥–∞–ª–∏—Ç–∏ –∞–ª—å–±–æ–º</button>
                            </div>
                                
                            </div>
                        </div>
                        
                        <div class = "theme-and-year">
                            <h4>{{ album_data.album.topic }}</h4>
                            <h5>{{ album_data.album.year }}</h5>
                        </div>

                        <hr>

                        <h4>–§–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó</h4>

                        <div class="photo-list" id="photo-list-{{ album_data.album.id }}">
                            {% for image in album_data.album.images.all %}
                                <div class="album-photo-container">
                                    <img src="{{ image.file.url }}" alt="{{ image.filename }}">
                                    <button type="button" class="delete-album-photo-btn" data-image-id="{{ image.id }}" data-album-id="{{ album_data.album.id }}">üóë</button>
                                </div>
                            {% endfor %}
                            
                            <button type="button"
                                    class="add-photo-button"
                                    data-album-id="{{ album_data.album.id }}">‚äï</button>

                            <input type="file" accept="image/*"
                                class="photo-input"
                                data-album-id="{{ album_data.album.id }}"
                                style="display: none;">
                        </div>
                        
                    </div>

                {% endfor %}
            {% endif %}
        </div>
        <!-- —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è -->
        <div id = "create-album-window-background" style="display: none; z-index: 999;" >
            <form id="create-album-window" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name="create_album" id="" value="create_album">
                <div id="exit-creation">
                    <p id = 'close-button'>
                        ‚®â
                    </p>
                </div>
                <h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ –∞–ª—å–±–æ–º</h3>
                <div id="inputs-create-album">
                    {{ create_album_form.as_p }}
                </div>
                <div id="buttons-create-album">
                    <button type="submit" id="cancel1" class="cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    <button type="submit" id="save1" class="save">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                </div>
            </form>
        </div>
        
        <!-- —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è -->
        <div id="edit-album-window-background" style="display: none; z-index: 999;">
            <form id="edit-album-form" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name = "edit_album" value = "edit_album">
                <input type="hidden" name = "album_id" id = "edit-album-id">


                <div id="exit-edit">
                    <p>‚®â</p>
                </div>

                <h3>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∞–ª—å–±–æ–º</h3>

                <div id="inputs-edit-album">
                    {{ edit_album_form.as_p }}
                </div>

                <div id="buttons-edit-album">
                    <button type="submit" class="cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    <button type="submit" class="save">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                </div>
            </form>
        </div>

    </div>
    <script src="{% static 'js/my_settings/albums.js' %}"></script>
{% endblock %}
